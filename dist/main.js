!function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);var n=class{constructor(t,e="empty"){this.coords=t,this.type=e,this.hidden=!0,this.flag=!1,this.tomatoCount=0}isTomato(){return"tomato"==this.type}isFlagged(){return this.flag}reveal(t){this.tomatoCount=t,this.hidden=!1,this.flag=!1}displayVal(){return"empty"==this.type&&!this.hidden&&this.tomatoCount>0?this.tomatoCount:""}getHTML(){return`<div id=${this.coords.join()} class="cell ${this.hidden?"hidden":this.type} ${this.flag?"flag":""}">${this.displayVal()}</div>`}};var i=class{constructor(t=10,e=10){this.newGame(t,e)}newGame(t,e){this.tomatoes=[],this.size=t;let o=t*t;this.tomatoCount=e>=o?o-1:e,this.cellsLeft=o-this.tomatoCount,this.state="play",this.grid=new Array(this.size);for(let t=0;t<this.size;t++){this.grid[t]=new Array(this.size);for(let e=0;e<this.size;e++)this.grid[t][e]=new n([t,e])}for(let t=0;t<this.tomatoCount;t++){let t;do{let e=Math.floor(Math.random()*this.size),o=Math.floor(Math.random()*this.size);t=this.grid[e][o]}while("tomato"==t.type);t.type="tomato",this.tomatoes.push(t)}}inbounds(t,e){return t>=0&&t<this.size&&e>=0&&e<this.size}getCell(t,e){return this.grid[t][e]}getNeighborCoords(t,e){if(!this.inbounds(t,e))return;let o=[];for(let n=-1;n<=1;n++)for(let i=-1;i<=1;i++)0==n&&0==i||this.inbounds(t+n,e+i)&&o.push([t+n,e+i]);return o}getNeighbors(t,e){if(!this.inbounds(t,e))return;let o=[];return this.getNeighborCoords(t,e).forEach(t=>{o.push(this.getCell(t[0],t[1]))}),o}getTomatoCount(t,e){let o=0;return this.getNeighbors(t,e).forEach(t=>{t.isTomato()&&o++}),o}reveal(t,e){let o=this.getCell(t,e);if(!o.hidden)return;if(o.isTomato()&&"play"==this.state)return void this.lose();let n=this.getTomatoCount(t,e);o.reveal(n),"play"==this.state&&(this.cellsLeft--,0==this.cellsLeft&&this.win()),0==n&&this.getNeighbors(t,e).forEach(t=>{this.reveal(t.coords[0],t.coords[1])})}revealUnflaggedNeighbors(t,e){this.getNeighborCoords(t,e).forEach(t=>{let e=t[0],o=t[1];this.getCell(e,o).isFlagged()||this.reveal(e,o)})}revealAll(){this.grid.forEach(t=>{t.forEach(t=>{this.reveal(t.coords[0],t.coords[1])})})}lose(){this.state="lost",this.revealAll()}win(){this.state="won",this.revealAll(),this.tomatoes.forEach(t=>{t.type="tomato-win"})}lost(){return"lost"==this.state}won(){return"won"==this.state}flagCell(t,e){this.getCell(t,e).flag=!0}unflagCell(t,e){this.getCell(t,e).flag=!1}getHTML(){let t="";return this.grid.forEach(e=>{t+="<div class='row'>",e.forEach(e=>{t+=e.getHTML()}),t+="</div>"}),t}};document.addEventListener("DOMContentLoaded",(function(t){const e=new i(10,10),o=document.querySelector("#field"),n=document.querySelector("#board-topper"),r=document.querySelector("#tomato-count"),s=document.querySelector("#blank-count"),l=document.querySelector("[name=board-size]"),a=document.querySelector("[name=tomato-count]"),u=document.querySelector("#new-game-modal-btn"),c=document.querySelectorAll(".new-game-btn"),d=document.querySelector("#modal"),h=(document.querySelector("#modal-content"),document.querySelector("#modal-message")),m={};m.gameEnd=document.querySelector("#game-end-modal"),m.newGameForm=document.querySelector("#new-game-form"),m.hide=function(){d.style.display="none",this.gameEnd.style.display="none",this.newGameForm.style.display="none"},m.show=function(t){d.style.display="block",this[t].style.display="block"};const f=document.querySelectorAll(".close-modal");for(let t=0;t<f.length;t++)f[t].onclick=function(){m.hide()};function g(){!function(t,o){e.newGame(t,o),n.innerHTML="Clear the board without squashing any tomatoes",d.classList.remove("modal-win"),y()}(l.value,a.value)}function y(){var t;r.innerHTML=e.tomatoCount,s.innerHTML=e.cellsLeft,o.innerHTML=e.getHTML(),"play"!=e.state&&(t=e.won(),n.innerHTML=t?"You Win!":"You Lose!",h.innerHTML=t?"Congratulations, You Win!":"You Squashed a Tomato!",t?d.classList.add("modal-win"):d.classList.remove("modal-win"),m.show("gameEnd"))}function p(t){let o=t.target;if(!o.classList.contains("cell"))return;"contextmenu"==t.type&&t.preventDefault();let n=o.id.split(","),i=Number(n[0]),r=Number(n[1]);o.classList.contains("hidden")?(o.classList.contains("flag")?e.unflagCell(i,r):"click"==t.type?e.reveal(i,r):e.flagCell(i,r),y()):"dblclick"==t.type&&(e.revealUnflaggedNeighbors(i,r),y())}d.onclick=function(t){t.target==d&&m.hide()},u.onclick=function(){m.show("newGameForm")},o.addEventListener("click",p),o.addEventListener("contextmenu",p),o.addEventListener("dblclick",p),c.forEach(t=>{t.addEventListener("click",g)}),y()}))}]);